window.addEvent('domready',function(){var assistant=new Element('div',{'class':'tl_assistant','id':'multiEditAssistant'}).inject($('main'));var assistantContainer=new Element('div',{'class':'tl_assistant_container'}).inject(assistant);var firstElement=null;var elements=$('main').getElements('.tl_form')[0].getElements('.tl_tbox');if(elements.length>0){Array.each(elements,function(element){if(firstElement==null){firstElement=element;}});}
var clone=firstElement.clone(true,true).cloneEvents(firstElement);clone.inject(assistantContainer);var fields=clone.getElements('[id^=ctrl_]');Array.each(fields,function(field){field.id=field.id.substring(0,field.id.lastIndexOf("_"));field.addEvent("click",function(){field.focus();});});fields=clone.getElements('[id^=opt_]');Array.each(fields,function(field){field.id=field.id.substring(0,field.id.lastIndexOf("_"));field.id=field.id.substring(0,field.id.lastIndexOf("_"));});fields=clone.getElements('[id^=check_all_]');Array.each(fields,function(field){field.id=field.id.substring(0,field.id.lastIndexOf("_"));var id="ctrl"+field.id.substring(field.id.lastIndexOf("_"),field.id.lenth);field.onclick=function(){Backend.toggleCheckboxGroup(this,id);};});new Drag.Move(assistant);assistant.style.top=(firstElement.offsetTop-clone.offsetTop)+"px";new Element('input',{'type':'submit','value':backendMultiEditAssistantButtonApplyToAll,'onclick':'backendMultiEditAssistantApplyToAll()'}).inject(assistantContainer);new Element('input',{'id':'buttonTableLayout','type':'submit','value':backendMultiEditAssistantButtonTableLayoutOn,'onclick':'backendMultiEditAssistantSwitchTableLayout()'}).inject(assistantContainer);if(isTablelayoutActive()){setTablelayoutBoxWidth();$("buttonTableLayout").value=backendMultiEditAssistantButtonTableLayoutOff;}else{$("buttonTableLayout").value=backendMultiEditAssistantButtonTableLayoutOn;}});function backendMultiEditAssistantApplyToAll(){var assitantFields=$('multiEditAssistant').getElements('[id^=ctrl_]');Array.each(assitantFields,function(assitantField){var fields=$('main').getElements('.tl_form')[0].getElements('[id^='+assitantField.id+']');Array.each(fields,function(field){field.value=assitantField.value;});});assitantFields=$('multiEditAssistant').getElements('[id^=opt_]');Array.each(assitantFields,function(assitantField){var fields=$('main').getElements('.tl_form')[0].getElements('[id^='+assitantField.id+']');Array.each(fields,function(field){if(field.value==assitantField.value){field.checked=assitantField.checked;}});});}
function backendMultiEditAssistantSwitchTableLayout(){if(isTablelayoutActive()){sheet=document.getElementById("tablelayout")
sheet.parentNode.removeChild(sheet);$("buttonTableLayout").value=backendMultiEditAssistantButtonTableLayoutOn;}else{Asset.css("system/modules/BackendMultiEditAssistant/html/tablelayout.css",{id:"tablelayout",onLoad:function(){setTablelayoutBoxWidth();}});$("buttonTableLayout").value=backendMultiEditAssistantButtonTableLayoutOff;}}
function isTablelayoutActive(){var styleSheets=document.getElementsByTagName("link");for(var i=0;i<styleSheets.length;i++){if(styleSheets[i]!=null&&styleSheets[i].href!=null&&styleSheets[i].href.search("tablelayout.css")>-1){styleSheets[i].setAttribute("id","tablelayout");return true;}}
return false;}
function setTablelayoutBoxWidth(){var fieldCount=$('main').getElements('.tl_formbody_edit')[0].getElements('.tl_tbox')[0].getElements('div').length;var fieldWidth=$('main').getElements('.tl_formbody_edit')[0].getElements('.tl_tbox')[0].getElements('div')[0].getStyle('width').toInt();var boxWidth=fieldCount*fieldWidth;$('main').getElements('.tl_formbody_edit')[0].getElements('.tl_tbox')[0].setStyle('width',boxWidth);fields=$('main').getElements('.tl_formbody_edit')[0].getElements('.tl_box');Array.each(fields,function(field){field.setStyle('width',boxWidth+"px")});}